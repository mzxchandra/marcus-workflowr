---
title: "Prior to summer: Cortex COTA SNP Mediation"
author: "Marcus Chandra"
date: "2025-07-01"
output: workflowr::wflow_html
site: workflowr::wflow_site
---

## Context

In this analysis, I applied the Gene-Gene case COTA mediation framework to a GTEx brain tissue dataset.
We use WES burden test results from the UK Biobank (UKBB) for our Gene 2 candidates.
We use an eQTL matrix from GTEx to detect trans effects from peripheral Gene 1 to Gene 2.

Key steps:
- Prepare UKBB wes p-values
- Load and clean the trans eQTL matrix.
- Run COTA using `med_gene()` function and `calc_pair.gene()` to match gene pairs for visualization.
- Visualize the network of significant mediation pairs.


- Load required R libraries for COTA analysis.

---

## ✅ **5. Code chunks**

---

**5.1. Load UKBB WES p-values**
- Read WES p-values from UKBB and format phenotype names.

**5.2. Load eQTL matrix**
- Load eQTL matrix, set threshold, and prepare candidate genes list.

**5.3. Run COTA mediation**
- Run COTA mediation analysis.

**5.4. Visualize mediation pairs**
- Visualize significant mediation pairs.

## ✅ **6. Add session info**
- Session information for reproducibility.
